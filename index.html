<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link href='./lib/fonts/fonts.css' rel="stylesheet"> -->
    <link href='./lib/fonts/material.css' rel="stylesheet">
    
    <link href="./lib/vuetify/vuetify-0.17.0.min.css" rel="stylesheet">

    <style>
        [v-cloak] {
            display: none;
        }
    </style>

    <title>EvaluateMe</title>
</head>

<body>
    <v-app id="app" v-cloak>

        <v-toolbar class="blue" dense fixed>
            <v-toolbar-title>
                <a href="/" class="white--text" style="text-decoration: none">EvaluateMe</a>
            </v-toolbar-title>
            <v-spacer></v-spacer>
            <template v-if="isAuthenticated">
                <v-toolbar-title v-if="auth.userName" class="text-xs-center" style="cursor:default;">
                    <p class="blue white--text" style="font-size:0.75em;margin:0 25px 0 0">Welcome {{ auth.userName }}</p>
                    <p v-if="auth.type" class="blue white--text" style="font-size:0.75em;margin:0 25px 0 0">Account type: {{ auth.type }}</p>
                </v-toolbar-title>
                <v-spacer></v-spacer>
                <v-toolbar-items>
                    <v-btn flat id="signout" @click="signOut" class="white--text">Sign out</v-btn>
                </v-toolbar-items>
            </template>
        </v-toolbar>
        <div class="ma-5"></div>

        <v-container v-if="loadAuth" fill-height class="mb-5">
            <v-container>

                <v-flex sm8 offset-sm2 md6 offset-md3>
                    <v-card>
                        <v-card-text>
                            <div id="login" class="tab-pane fade in active register">
                                <v-container fluid>
                                    <v-layout row wrap>
                                        <v-flex class="green--text">
                                            <v-layout class="justify-center">
                                                <h1>Login</h1>
                                            </v-layout>
                                        </v-flex>

                                        <v-flex xs12>
                                            <v-text-field name="uname" label="Email" prepend-icon="email" v-model:email="auth.email" @keydown.enter="newLogin" single-line></v-text-field>
                                        </v-flex>

                                        <v-flex xs12>
                                            <v-text-field name="pass" label="Password" prepend-icon="work" v-model:password="auth.password" @keydown.enter="newLogin"
                                                single-line :append-icon="e1 ? 'visibility' : 'visibility_off'" :append-icon-cb="() => (e1 = !e1)"
                                                :type="e1 ? 'password' : 'text'"></v-text-field>
                                        </v-flex>
                                    </v-layout>
                                </v-container>
                            </div>
                            <!--
                                    <div class="col-xs-6 col-sm-6 col-md-6">
                                        <div class="form-group">
                                            <input type="checkbox" name="check" checked="checked"> Remember Me
                                        </div>
                                    </div>
                                    <div class="col-xs-6 col-sm-6 col-md-6">
                                        <div class="form-group">
                                            <a href="#forgot" data-toggle="modal"> Forgot Password? </a>
                                        </div>
                                    </div>
                                <hr>
                            -->
                        </v-card-text>
                        <v-card-actions class="pb-3">
                            <v-layout row wrap>
                                <v-layout class="justify-center" sm12>
                                    <v-btn @click="newLogin" class="green white--text">
                                        Login
                                        <v-icon>forward</v-icon>
                                    </v-btn>
                                </v-layout>

                        </v-card-actions>
                    </v-card>

                    <v-flex v-if="auth.message !== ''" @click="dismissAlert" :class="{'red': auth.hasErrors, 'green': !auth.hasErrors}">
                        <v-btn flat>
                            <p>{{ auth.message }}</p>
                        </v-btn>
                    </v-flex>
                </v-flex>

            </v-container>
        </v-container>

        <v-container v-else-if="isAuthenticated" id="content" class="container">

            <div v-if="auth.message !== ''">
                <div :class="{'red white--text': auth.hasErrors, 'green white--text': !auth.hasErrors}">
                    <button @click="dismissAlert" type="button" class="close">
                        <span aria-hidden="true">Ã—</span>
                    </button>
                    <p>
                        <strong>{{auth.message}}</strong>
                    </p>
                </div>
            </div>

            <div v-if="auth.type == 'Admin'">
                <app-admin></app-admin>
            </div>

            <div v-else-if="auth.type == 'Coordinator'">
                <app-coordinator></app-coordinator>
            </div>

            <div v-else-if="auth.type == 'Advisor'">
                <app-advisor></app-advisor>
            </div>

            <div v-else-if="auth.type == 'Supervisor'">
                <app-supervisor></app-supervisor>
            </div>

            <div v-else-if="auth.type == 'disabled'">
                <p style="text-align:center">Your account is disabled, contact system's admin!</p>
            </div>

            <div v-else-if="!loaded">
                <p style="text-align:center">Loading!</p>
                <!-- //TBD: more visual loading screen -->
            </div>
        </v-container>

        <app-footer></app-footer>
    </v-app>

    <js>
        <!-- Libraries -->
        <script src="./lib/jquery/jquery-3.2.1.min.js"></script>
        <script src="./lib/vue/vue-2.5.0.min.js"></script>
        <script src="./lib/vuetify/vuetify-0.17.0.min.js"></script>

        <!-- Firebase -->
        <script src="./lib/firebase/firebase-4.6.0.min.js"></script>
        <script src="./firebase/config.js"></script>
        <script src="./firebase/functions.js"></script>

        <script>
            function newLogin() {
                app.login();
            };
        </script>

        <!-- Login's -->
        <script src="./components/login/app-field.js"></script>
        <script src="./components/login/app-container.js"></script>
        <script src="./components/login/app-login.js"></script>
        <script src="./components/login/app-forget-modal.js"></script>

        <!-- Dashboards -->
        <script src="./components/dashboards/app-admin.js"></script>
        <script src="./components/dashboards/app-advisor.js"></script>
        <script src="./components/dashboards/app-coordinator.js"></script>
        <script src="./components/dashboards/app-supervisor.js"></script>

        <!-- Common -->
        <script src="./components/vuetify-dashboard/app-option.js"></script>
        <script src="./components/vuetify-dashboard/app-dashboard.js"></script>
        <script src="./components/vuetify-dashboard/app-dashboard-no-container.js"></script>
        <script src="./components/vuetify-dashboard/app-footer.js"></script>

        <!-- Vue main -->
        <script src="./res/js/app.js"></script>
    </js>

</body>

</html>